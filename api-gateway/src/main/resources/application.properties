server.port=8084

spring.application.name=api-gateway

eureka.client.service-url.defaultZone=http://localhost:8761/eureka
eureka.client.fetch-registry=true
eureka.client.register-with-eureka=true

eureka.instance.hostname=localhost
eureka.instance.prefer-ip-address=false

# --- JWT SECRET KEY ---
spring.security.oauth2.resourceserver.jwt.secret-key=YmU2NjUyYjMyZmMxZTY5ODRmMjU3MDI4YjZkZGNlYjU0Njk5YmU1OTVmN2NmZWIyYjUwNTE4ZGNmYjYxMTBiNg==


# --- GATEWAY ROUTING RULES ---
# Using direct IPs since DNS resolution doesn't work properly in this Kubernetes cluster
# Routes will be configured via environment variables in Kubernetes deployment
spring.cloud.gateway.routes[0].id=user-service
spring.cloud.gateway.routes[0].uri=${USER_SERVICE_URI:lb://user-service}
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/users/**

spring.cloud.gateway.routes[1].id=blog-service
spring.cloud.gateway.routes[1].uri=${BLOG_SERVICE_URI:lb://blog-service}
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/blogs/**

spring.cloud.gateway.routes[2].id=engagement-service
spring.cloud.gateway.routes[2].uri=${ENGAGEMENT_SERVICE_URI:lb://engagement-service}
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/engagement/**

# Request body size limits (for large base64 image URLs)
# Default is 256KB, increasing to 50MB to handle base64-encoded images
spring.codec.max-in-memory-size=50MB
# Increase timeouts for large requests with base64 images
# connect-timeout is in milliseconds (30000 = 30 seconds)
# response-timeout uses Duration format
spring.cloud.gateway.httpclient.response-timeout=PT60S
spring.cloud.gateway.httpclient.connect-timeout=30000
